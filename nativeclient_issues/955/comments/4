<ns0:entry xmlns:ns0="http://www.w3.org/2005/Atom" xmlns:ns1="http://schemas.google.com/g/2005" xmlns:ns2="http://schemas.google.com/projecthosting/issues/2009" ns1:etag="W/&quot;C08ESX47eCl7ImA9Wx9WFkg.&quot;">
		<ns0:id>http://code.google.com/feeds/issues/p/nativeclient/issues/955/comments/full/4</ns0:id><ns0:author>
			<ns0:name>bugdro...@chromium.org</ns0:name><ns0:uri>/u/101788990881243245974/</ns0:uri></ns0:author><ns0:content type="html">The following revision refers to this bug:
    http://src.chromium.org/viewvc/chrome?view=rev&amp;revision=3559

------------------------------------------------------------------------
r3559 | noelallen@google.com | Mon Oct 25 18:18:41 PDT 2010

Changed paths:
 M http://src.chromium.org/viewvc/chrome/trunk/src/native_client/src/trusted/service_runtime/service_runtime.gyp?r1=3559&amp;r2=3558&amp;pathrev=3559
 M http://src.chromium.org/viewvc/chrome/trunk/src/native_client/src/trusted/service_runtime/nacl_signal_common.c?r1=3559&amp;r2=3558&amp;pathrev=3559
 A http://src.chromium.org/viewvc/chrome/trunk/src/native_client/src/trusted/service_runtime/arch/arm/nacl_signal_arm.h?r1=3559&amp;r2=3558&amp;pathrev=3559
 M http://src.chromium.org/viewvc/chrome/trunk/src/native_client/src/trusted/service_runtime/arch/x86_32/service_runtime_x86_32.gyp?r1=3559&amp;r2=3558&amp;pathrev=3559
 M http://src.chromium.org/viewvc/chrome/trunk/src/native_client/src/trusted/service_runtime/arch/x86_64/service_runtime_x86_64.gyp?r1=3559&amp;r2=3558&amp;pathrev=3559
 A http://src.chromium.org/viewvc/chrome/trunk/src/native_client/src/trusted/service_runtime/linux/nacl_signal_arm.c?r1=3559&amp;r2=3558&amp;pathrev=3559
 A http://src.chromium.org/viewvc/chrome/trunk/src/native_client/src/trusted/service_runtime/win/nacl_signal_64.c?r1=3559&amp;r2=3558&amp;pathrev=3559
 M http://src.chromium.org/viewvc/chrome/trunk/src/native_client/src/trusted/service_runtime/build.scons?r1=3559&amp;r2=3558&amp;pathrev=3559
 M http://src.chromium.org/viewvc/chrome/trunk/src/native_client/tests/signal_handler/nacl.scons?r1=3559&amp;r2=3558&amp;pathrev=3559
 M http://src.chromium.org/viewvc/chrome/trunk/src/native_client/src/trusted/service_runtime/nacl_signal.h?r1=3559&amp;r2=3558&amp;pathrev=3559
 A http://src.chromium.org/viewvc/chrome/trunk/src/native_client/src/trusted/service_runtime/arch/x86_32/nacl_signal_32.h?r1=3559&amp;r2=3558&amp;pathrev=3559
 A http://src.chromium.org/viewvc/chrome/trunk/src/native_client/src/trusted/service_runtime/arch/x86_64/nacl_signal_64.h?r1=3559&amp;r2=3558&amp;pathrev=3559
 A http://src.chromium.org/viewvc/chrome/trunk/src/native_client/src/trusted/service_runtime/win/nacl_signal_32.c?r1=3559&amp;r2=3558&amp;pathrev=3559
 M http://src.chromium.org/viewvc/chrome/trunk/src/native_client/src/trusted/service_runtime/nacl_signal_unittest.c?r1=3559&amp;r2=3558&amp;pathrev=3559
 A http://src.chromium.org/viewvc/chrome/trunk/src/native_client/src/trusted/service_runtime/linux/nacl_signal_64.c?r1=3559&amp;r2=3558&amp;pathrev=3559
 A http://src.chromium.org/viewvc/chrome/trunk/src/native_client/src/trusted/service_runtime/osx/nacl_signal_64.c?r1=3559&amp;r2=3558&amp;pathrev=3559
 A http://src.chromium.org/viewvc/chrome/trunk/src/native_client/src/trusted/service_runtime/linux/nacl_signal_32.c?r1=3559&amp;r2=3558&amp;pathrev=3559
 A http://src.chromium.org/viewvc/chrome/trunk/src/native_client/src/trusted/service_runtime/osx/nacl_signal_32.c?r1=3559&amp;r2=3558&amp;pathrev=3559
 M http://src.chromium.org/viewvc/chrome/trunk/src/native_client/src/trusted/service_runtime/win/nacl_signal.c?r1=3559&amp;r2=3558&amp;pathrev=3559
 M http://src.chromium.org/viewvc/chrome/trunk/src/native_client/src/trusted/platform_qualify/win/nacl_dep_qualify.c?r1=3559&amp;r2=3558&amp;pathrev=3559
 M http://src.chromium.org/viewvc/chrome/trunk/src/native_client/tools/command_tester.py?r1=3559&amp;r2=3558&amp;pathrev=3559
 M http://src.chromium.org/viewvc/chrome/trunk/src/native_client/src/trusted/service_runtime/posix/nacl_signal.c?r1=3559&amp;r2=3558&amp;pathrev=3559

Add NaClSignalContext to allow for holding regsiters for signal processing and debugging.

Split out architecture depending pieces (removing lots of macros)
Added &lt;os&gt;/nacl_signal_&lt;arch&gt;.c for translating to and from ucontext to signal context
Added arch/&lt;arch&gt;/nacl_signal_&lt;arch&gt;.h for describing an architecture (matches gdb_rsp/abi.cc).

Updated failure messages to print out location of error as well as trusted/untrusted.

Updated nacl_dep_qualify to use new signal system.
Updated nacl_signal_unittest to check for a trusted signal on exit.

Updated scons &amp; gyp files to add new sources.

Updated command_tester.py to scan for "Signal" signature to determine if the return code was
generated by a trusted exception, an untrusted, or a normal exit/exception (not caught).

Remove regex check from crash_test since command_tester.py now always performs the check.

Fixes issue in POSIX case, pulling GS out of the UCONTEXT in case the OS changed it.
Fixes issue with checking 'cs' from handler instead of signal context
Fixes issue with windows regex being disabled.


BUG=http://code.google.com/p/nativeclient/issues/detail?id=955
TEST=nacl_signal_unittest, crash_test


Review URL: http://codereview.chromium.org/3786007
------------------------------------------------------------------------</ns0:content><ns0:updated>2011-01-21T23:16:48.000Z</ns0:updated><ns0:published>2011-01-21T23:16:48.000Z</ns0:published><ns2:updates /><ns0:title>Comment 4 by bugdro...@chromium.org</ns0:title><ns0:link href="http://code.google.com/p/nativeclient/issues/detail?id=955#c4" rel="alternate" type="text/html" /><ns0:link href="https://code.google.com/feeds/issues/p/nativeclient/issues/955/comments/full/4" rel="self" type="application/atom+xml" /></ns0:entry>