<ns0:entry xmlns:ns0="http://www.w3.org/2005/Atom" xmlns:ns1="http://schemas.google.com/g/2005" xmlns:ns2="http://schemas.google.com/projecthosting/issues/2009" ns1:etag="W/&quot;CEYHSH47eCl7ImA9WhdWFUQ.&quot;">
		<ns0:id>http://code.google.com/feeds/issues/p/nativeclient/issues/full/2075</ns0:id><ns0:author>
			<ns0:name>b...@google.com</ns0:name><ns0:uri>/u/105821748722532785568/</ns0:uri></ns0:author><ns0:content type="html">NaCl_mprotect will MEM_DECOMMIT pages when PROT_NONE is used, so removing access and re-enabling access to pages will surprisingly cause the contents to disappear.  this hack was done a while back to reduce virtual memory usage (and swap) for windows.  while this cause problems for developers only and is an abstraction cleanliness issue primarily for windows, this should be fixed.

we should revert NaCl_mprotect's PROT_NONE to VirtualProtect PAGE_NOACCESS and not VirtualFree MEM_DECOMMIT.  and we should provide a NaCl_mem_squat function to mark pages as for address space squatting -- to PAGE_NOACCESS and MEM_DECOMMIT or mprotect PROT_NONE madvise MADV_DONTNEED, and convert existing calls to NaCl_mprotect PROT_NONE use cases that need this behavior to use the new function.</ns0:content><ns0:updated>2011-09-09T18:15:39.000Z</ns0:updated><ns0:published>2011-07-22T18:47:32.000Z</ns0:published><ns2:status>Assigned</ns2:status><ns2:owner>
			<ns2:uri>/u/105821748722532785568/</ns2:uri><ns2:username>b...@google.com</ns2:username></ns2:owner><ns2:state>open</ns2:state><ns0:title>NaCl_mprotect PROT_NONE is a hack</ns0:title><ns2:label>Type-Defect</ns2:label><ns2:label>Mstone-15</ns2:label><ns2:label>Pri-2</ns2:label><ns2:label>Component-TCB</ns2:label><ns2:label>OS-All</ns2:label><ns2:label>Arch-All</ns2:label><ns0:link href="http://code.google.com/feeds/issues/p/nativeclient/issues/2075/comments/full" rel="replies" type="application/atom+xml" /><ns0:link href="http://code.google.com/p/nativeclient/issues/detail?id=2075" rel="alternate" type="text/html" /><ns0:link href="https://code.google.com/feeds/issues/p/nativeclient/issues/full/2075" rel="self" type="application/atom+xml" /><ns2:stars>1</ns2:stars><ns2:id>2075</ns2:id></ns0:entry>