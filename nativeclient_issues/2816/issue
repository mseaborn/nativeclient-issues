<ns0:entry xmlns:ns0="http://www.w3.org/2005/Atom" xmlns:ns1="http://schemas.google.com/g/2005" xmlns:ns2="http://schemas.google.com/projecthosting/issues/2009" ns1:etag="W/&quot;DUQGRH47eCl7ImA9WhNWE04.&quot;">
		<ns0:id>http://code.google.com/feeds/issues/p/nativeclient/issues/full/2816</ns0:id><ns0:author>
			<ns0:name>kschi...@google.com</ns0:name><ns0:uri>/u/108470876877739532758/</ns0:uri></ns0:author><ns0:content type="html">The arm manual defines UNPREDICTABLE in many instructions when certain combinations of registers (and bit flags) are set. Unfortunately, there is no notion of how serious the unpredictability is.

The specific case that introduced this issue is store immediate instructions. The manual states that if writeback occurs, and Rn=Rt, then the results are UNPREDICTABLE. However, the compilers are generating such instructions. For example:

   27470:	e3c11103 	bic	r1, r1, #-1073741824	; 0xc0000000
   27474:	e5211004 	str	r1, [r1, #-4]!

If we follow the rules of the manual, we would not allow the store at address 27474, but it is generated by the compiler.

&lt;b&gt;What steps will reproduce the problem?&lt;/b&gt;

1. ./scons --mode=opt-linux platform=arm medium_tests

This will run the arm-ncval-core validator on src/service_runtime/testdata/arm/hello_world.nexe, which
has the store immediate example above.

The output is:

ncval: 00027474 2 kProblemUnsafe 00000000

For now, I am modifying the ARM validator to accept such store instructions, but have added TODO's to indicate the modified code.</ns0:content><ns0:updated>2012-12-12T18:35:25.000Z</ns0:updated><ns0:published>2012-05-31T18:41:09.000Z</ns0:published><ns2:status>Fixed</ns2:status><ns2:owner>
			<ns2:uri>/u/109636895838879576326/</ns2:uri><ns2:username>j...@chromium.org</ns2:username></ns2:owner><ns2:cc>
			<ns2:uri>/u/108470876877739532758/</ns2:uri><ns2:username>kschi...@google.com</ns2:username></ns2:cc><ns2:state>closed</ns2:state><ns0:title>Notions of UNPREDICTABLE in ARM (str in particular)</ns0:title><ns2:label>Type-Defect</ns2:label><ns2:label>Mstone-25</ns2:label><ns2:label>Pri-1</ns2:label><ns2:label>Component-TCB-Validator</ns2:label><ns2:label>OS-All</ns2:label><ns2:label>Arch-ARM</ns2:label><ns2:label>ARMABI</ns2:label><ns0:link href="http://code.google.com/feeds/issues/p/nativeclient/issues/2816/comments/full" rel="replies" type="application/atom+xml" /><ns0:link href="http://code.google.com/p/nativeclient/issues/detail?id=2816" rel="alternate" type="text/html" /><ns0:link href="https://code.google.com/feeds/issues/p/nativeclient/issues/full/2816" rel="self" type="application/atom+xml" /><ns2:stars>2</ns2:stars><ns2:closedDate>2012-12-12T18:34:51.000Z</ns2:closedDate><ns2:id>2816</ns2:id></ns0:entry>