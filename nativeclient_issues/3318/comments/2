<ns0:entry xmlns:ns0="http://www.w3.org/2005/Atom" xmlns:ns1="http://schemas.google.com/g/2005" xmlns:ns2="http://schemas.google.com/projecthosting/issues/2009" ns1:etag="W/&quot;C0YFSX47eCl7ImA9WhBQEU8.&quot;">
		<ns0:id>http://code.google.com/feeds/issues/p/nativeclient/issues/3318/comments/full/2</ns0:id><ns0:author>
			<ns0:name>bugdro...@chromium.org</ns0:name><ns0:uri>/u/101788990881243245974/</ns0:uri></ns0:author><ns0:content type="html">The following revision refers to this bug:
    http://src.chromium.org/viewvc/native_client?view=rev&amp;revision=10969

------------------------------------------------------------------------
r10969 | bsy@google.com | 2013-03-12T20:42:52.401546Z

Changed paths:
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/nonnacl_util/nonnacl_util.gyp?r1=10969&amp;r2=10968&amp;pathrev=10969
   A http://src.chromium.org/viewvc/native_client/trunk/src/native_client/tests/subprocess?r1=10969&amp;r2=10968&amp;pathrev=10969
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/reverse_service/reverse_service_c.c?r1=10969&amp;r2=10968&amp;pathrev=10969
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/sel_universal/sel_universal.cc?r1=10969&amp;r2=10968&amp;pathrev=10969
   A http://src.chromium.org/viewvc/native_client/trunk/src/native_client/tests/subprocess/nacl.scons?r1=10969&amp;r2=10968&amp;pathrev=10969
   A http://src.chromium.org/viewvc/native_client/trunk/src/native_client/tests/subprocess/scoped_non_ptr.h?r1=10969&amp;r2=10968&amp;pathrev=10969
   A http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/nonnacl_util/sel_ldr_launcher_zygote_base.h?r1=10969&amp;r2=10968&amp;pathrev=10969
   A http://src.chromium.org/viewvc/native_client/trunk/src/native_client/tests/subprocess/subprogram.c?r1=10969&amp;r2=10968&amp;pathrev=10969
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/reverse_service/reverse_service_c.h?r1=10969&amp;r2=10968&amp;pathrev=10969
   A http://src.chromium.org/viewvc/native_client/trunk/src/native_client/tests/subprocess/subprocess_test.stdin?r1=10969&amp;r2=10968&amp;pathrev=10969
   A http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/nonnacl_util/sel_ldr_launcher_zygote.h?r1=10969&amp;r2=10968&amp;pathrev=10969
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/service_runtime/nacl_kernel_service.c?r1=10969&amp;r2=10968&amp;pathrev=10969
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/site_scons/site_tools/library_deps.py?r1=10969&amp;r2=10968&amp;pathrev=10969
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/SConstruct?r1=10969&amp;r2=10968&amp;pathrev=10969
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/sel_universal/reverse_emulate.cc?r1=10969&amp;r2=10968&amp;pathrev=10969
   A http://src.chromium.org/viewvc/native_client/trunk/src/native_client/tests/subprocess/init.cc?r1=10969&amp;r2=10968&amp;pathrev=10969
   A http://src.chromium.org/viewvc/native_client/trunk/src/native_client/tests/subprocess/process_lib.cc?r1=10969&amp;r2=10968&amp;pathrev=10969
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/tests/manifest_file/srpc_manifest_file_test.c?r1=10969&amp;r2=10968&amp;pathrev=10969
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/desc/nacl_desc_imc.c?r1=10969&amp;r2=10968&amp;pathrev=10969
   A http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/nonnacl_util/posix/sel_ldr_launcher_zygote_posix.cc?r1=10969&amp;r2=10968&amp;pathrev=10969
   A http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/nonnacl_util/launcher_factory.h?r1=10969&amp;r2=10968&amp;pathrev=10969
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/nonnacl_util/build.scons?r1=10969&amp;r2=10968&amp;pathrev=10969
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/reverse_service/reverse_service.cc?r1=10969&amp;r2=10968&amp;pathrev=10969
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/reverse_service/reverse_service.h?r1=10969&amp;r2=10968&amp;pathrev=10969
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/nonnacl_util/sel_ldr_launcher.h?r1=10969&amp;r2=10968&amp;pathrev=10969
   A http://src.chromium.org/viewvc/native_client/trunk/src/native_client/tests/subprocess/subprocess_test.stdout?r1=10969&amp;r2=10968&amp;pathrev=10969
   A http://src.chromium.org/viewvc/native_client/trunk/src/native_client/tests/subprocess/scoped_lock.h?r1=10969&amp;r2=10968&amp;pathrev=10969
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/nonnacl_util/win/sel_ldr_launcher_win.cc?r1=10969&amp;r2=10968&amp;pathrev=10969
   A http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/nonnacl_util/win/sel_ldr_launcher_zygote_win.h?r1=10969&amp;r2=10968&amp;pathrev=10969
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/reverse_service/reverse_control_rpc.h?r1=10969&amp;r2=10968&amp;pathrev=10969
   A http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/nonnacl_util/launcher_factory.cc?r1=10969&amp;r2=10968&amp;pathrev=10969
   A http://src.chromium.org/viewvc/native_client/trunk/src/native_client/tests/subprocess/process_lib.h?r1=10969&amp;r2=10968&amp;pathrev=10969
   A http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/nonnacl_util/posix/sel_ldr_launcher_zygote_posix.h?r1=10969&amp;r2=10968&amp;pathrev=10969

Subprocess creation test, along with sel_universal, nonnacl_util, etc changes to make it work.

The real implementation of the subprocess creation hooks are in the plugin code, but it is difficult to test.  we would want a browser test, and that cannot run on the NaCl build bots.  So, we need an implementation in sel_universal that "should" implement the same interface and provide some assurance that if the NaCl build bots succeed, the Chromium bots will too.

This CL changes: the windows standalone launcher to not create a new console; the standalone launcher module to use a zygote process for Linux and OSX, since using it to launch multiple processes result in descriptor inheritance issues; and the reverse service interface to fix a potential race condition, where a process's state information might be freed before the RPC reply for the process creation has been sent.

BUG= https://code.google.com/p/nativeclient/issues/detail?id=3318

Review URL: https://codereview.chromium.org/12461007
------------------------------------------------------------------------</ns0:content><ns0:updated>2013-03-12T20:45:18.000Z</ns0:updated><ns0:published>2013-03-12T20:45:18.000Z</ns0:published><ns2:updates /><ns0:title>Comment 2 by bugdro...@chromium.org</ns0:title><ns0:link href="http://code.google.com/p/nativeclient/issues/detail?id=3318#c2" rel="alternate" type="text/html" /><ns0:link href="https://code.google.com/feeds/issues/p/nativeclient/issues/3318/comments/full/2" rel="self" type="application/atom+xml" /></ns0:entry>