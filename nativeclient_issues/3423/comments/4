<ns0:entry xmlns:ns0="http://www.w3.org/2005/Atom" xmlns:ns1="http://schemas.google.com/g/2005" xmlns:ns2="http://schemas.google.com/projecthosting/issues/2009" ns1:etag="W/&quot;A0EHSH47eCl7ImA9WhBaEkk.&quot;">
		<ns0:id>http://code.google.com/feeds/issues/p/nativeclient/issues/3423/comments/full/4</ns0:id><ns0:author>
			<ns0:name>bugdro...@chromium.org</ns0:name><ns0:uri>/u/101788990881243245974/</ns0:uri></ns0:author><ns0:content type="html">The following revision refers to this bug:
    http://src.chromium.org/viewvc/native_client?view=rev&amp;revision=11367

------------------------------------------------------------------------
r11367 | bsy@google.com | 2013-05-20T20:57:36.734611Z

Changed paths:
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/shared/platform/win/nacl_host_desc.c?r1=11367&amp;r2=11366&amp;pathrev=11367
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/desc/nacl_desc_imc_bound_desc.c?r1=11367&amp;r2=11366&amp;pathrev=11367
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/desc/posix/nacl_desc_imc_bound_desc.c?r1=11367&amp;r2=11366&amp;pathrev=11367
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/shared/platform/posix/nacl_host_desc.c?r1=11367&amp;r2=11366&amp;pathrev=11367
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/desc/nacl_desc_mutex.c?r1=11367&amp;r2=11366&amp;pathrev=11367
   A http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/shared/platform/nacl_host_desc_pread_pwrite_test.c?r1=11367&amp;r2=11366&amp;pathrev=11367
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/shared/platform/nacl_host_desc.h?r1=11367&amp;r2=11366&amp;pathrev=11367
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/desc/nacl_desc_io.c?r1=11367&amp;r2=11366&amp;pathrev=11367
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/shared/platform/nacl_host_desc_mmap_test.c?r1=11367&amp;r2=11366&amp;pathrev=11367
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/desc/nacl_desc_imc.c?r1=11367&amp;r2=11366&amp;pathrev=11367
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/desc/nacl_desc_null.c?r1=11367&amp;r2=11366&amp;pathrev=11367
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/desc/linux/nacl_desc_sysv_shm.c?r1=11367&amp;r2=11366&amp;pathrev=11367
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/desc/nacl_desc_base.c?r1=11367&amp;r2=11366&amp;pathrev=11367
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/desc/nacl_desc_custom.c?r1=11367&amp;r2=11366&amp;pathrev=11367
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/desc/nacl_desc_dir.c?r1=11367&amp;r2=11366&amp;pathrev=11367
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/desc/nacl_desc_base.h?r1=11367&amp;r2=11366&amp;pathrev=11367
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/desc/nacl_desc_imc_shm.c?r1=11367&amp;r2=11366&amp;pathrev=11367
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/service_runtime/nacl_desc_postmessage.c?r1=11367&amp;r2=11366&amp;pathrev=11367
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/desc/nacl_desc_conn_cap.c?r1=11367&amp;r2=11366&amp;pathrev=11367
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/desc/posix/nacl_desc_conn_cap.c?r1=11367&amp;r2=11366&amp;pathrev=11367
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/desc/nacl_desc_cond.c?r1=11367&amp;r2=11366&amp;pathrev=11367
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/desc/nacl_desc_semaphore.c?r1=11367&amp;r2=11366&amp;pathrev=11367
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/desc/nacl_desc_sync_socket.c?r1=11367&amp;r2=11366&amp;pathrev=11367
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/shared/platform/win/nacl_host_desc_types.h?r1=11367&amp;r2=11366&amp;pathrev=11367
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/desc/nacl_desc_invalid.c?r1=11367&amp;r2=11366&amp;pathrev=11367
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/desc/nacl_desc_rng.c?r1=11367&amp;r2=11366&amp;pathrev=11367
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/trusted/desc/nacl_desc_quota.c?r1=11367&amp;r2=11366&amp;pathrev=11367
   M http://src.chromium.org/viewvc/native_client/trunk/src/native_client/src/shared/platform/build.scons?r1=11367&amp;r2=11366&amp;pathrev=11367

pread/pwrite implementation.  NaClHostDesc level, plus NaClDesc plumbing.

Since FileRead / FileWrite OVERLAPPED is used in Windows, and contrary to MSDN documentation, the offset update occurs to the implicit offset rather than the explicit offset in the OVERLAPPED structure, the NaClHostDescRead and NaClHostDescWrite functions were converted over to use FileRead / FileWrite as well, instead of using the Posix emulation layer.  We still use Posix emulation for _fstat64.  Seek becomes just updating the offsets in the explicit OVERLAPPED structure.

BUG= https://code.google.com/p/nativeclient/issues/detail?id=3423
TEST= run_nacl_host_desc_pread_pwrite_test
R=mcgrathr@chromium.org

Review URL: https://codereview.chromium.org/14599003
------------------------------------------------------------------------</ns0:content><ns0:updated>2013-05-22T19:07:19.000Z</ns0:updated><ns0:published>2013-05-22T19:07:19.000Z</ns0:published><ns2:updates /><ns0:title>Comment 4 by bugdro...@chromium.org</ns0:title><ns0:link href="http://code.google.com/p/nativeclient/issues/detail?id=3423#c4" rel="alternate" type="text/html" /><ns0:link href="https://code.google.com/feeds/issues/p/nativeclient/issues/3423/comments/full/4" rel="self" type="application/atom+xml" /></ns0:entry>