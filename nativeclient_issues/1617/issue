<ns0:entry xmlns:ns0="http://www.w3.org/2005/Atom" xmlns:ns1="http://schemas.google.com/g/2005" xmlns:ns2="http://schemas.google.com/projecthosting/issues/2009" ns1:etag="W/&quot;DEUFR347eCl7ImA9WhdUEEg.&quot;">
		<ns0:id>http://code.google.com/feeds/issues/p/nativeclient/issues/full/1617</ns0:id><ns0:author>
			<ns0:name>b...@google.com</ns0:name><ns0:uri>/u/105821748722532785568/</ns0:uri></ns0:author><ns0:content type="html">NaClSrpcClientCtor (and similarly server channel) takes an int or a NaClDesc* as argument.  in untrusted code, the descriptor is used and is not closed on the channel dtor; in trusted code, an additional reference is take on the NaClDesc in the ctor, and the desc is unref'd in the dtor.

this means that in untrusted code, the caller must ensure that the lifetime of the descriptor is at least that of the channel, but this requirement is not necessary in trusted code.  it would be better if users don't need to remember this.

while it suffices to always ensure that the lifetime of the desc is at least that of the channel, it would probably be better to just dup the descriptor in the untrusted ctor and close the reference in the untrusted dtor.</ns0:content><ns0:updated>2011-09-26T16:56:56.000Z</ns0:updated><ns0:published>2011-04-06T20:12:05.000Z</ns0:published><ns2:status>Available</ns2:status><ns2:cc>
			<ns2:uri>/u/108394971971967673680/</ns2:uri><ns2:username>s...@google.com</ns2:username></ns2:cc><ns2:state>open</ns2:state><ns0:title>SRPC channel ctor handle lifetime</ns0:title><ns2:label>Type-Defect</ns2:label><ns2:label>Pri-3</ns2:label><ns2:label>Component-TCB</ns2:label><ns2:label>OS-All</ns2:label><ns2:label>Arch-All</ns2:label><ns2:label>Mstone-16</ns2:label><ns0:link href="http://code.google.com/feeds/issues/p/nativeclient/issues/1617/comments/full" rel="replies" type="application/atom+xml" /><ns0:link href="http://code.google.com/p/nativeclient/issues/detail?id=1617" rel="alternate" type="text/html" /><ns0:link href="https://code.google.com/feeds/issues/p/nativeclient/issues/full/1617" rel="self" type="application/atom+xml" /><ns2:stars>1</ns2:stars><ns2:id>1617</ns2:id></ns0:entry>