<ns0:entry xmlns:ns0="http://www.w3.org/2005/Atom" xmlns:ns1="http://schemas.google.com/g/2005" xmlns:ns2="http://schemas.google.com/projecthosting/issues/2009" ns1:etag="W/&quot;DEUFR347eCl7ImA9WhdUEEg.&quot;">
		<ns0:id>http://code.google.com/feeds/issues/p/nativeclient/issues/full/1696</ns0:id><ns0:author>
			<ns0:name>mseaborn@chromium.org</ns0:name><ns0:uri>/u/mseaborn@chromium.org/</ns0:uri></ns0:author><ns0:content type="html">The nacl_log.h/nacl_check.h interfaces are awkward to use, especially in small programs, because NaClLog() crashes if NaClLogModuleInit() was called.

This means that CHECK(x) crashes if x is false.  This is not very helpful because it means that instead of debugging the real problem (x being false), you first have to debug another problem (why the program crashes).

There is not always a good place to call NaClLogModuleInit().  If you're linking against libppruntime (a non-IRT build), PpapiPluginMain() calls NaClLogModuleInit() for you.  Otherwise, you have to call NaClLogModuleInit() yourself -- presumably in PPP_InitializeModule(), if we're not supporting a user-supplied main().

It would be better if NaClLog()/CHECK() were self-initialising.
</ns0:content><ns0:updated>2011-09-26T16:56:56.000Z</ns0:updated><ns0:published>2011-04-19T15:16:30.000Z</ns0:published><ns2:status>Available</ns2:status><ns2:state>open</ns2:state><ns0:title>nacl_check.h's CHECK() crashes if NaClLogModuleInit() was not called</ns0:title><ns2:label>Type-Enhancement</ns2:label><ns2:label>Pri-3</ns2:label><ns2:label>OS-All</ns2:label><ns2:label>Component-IRT</ns2:label><ns2:label>Mstone-16</ns2:label><ns0:link href="http://code.google.com/feeds/issues/p/nativeclient/issues/1696/comments/full" rel="replies" type="application/atom+xml" /><ns0:link href="http://code.google.com/p/nativeclient/issues/detail?id=1696" rel="alternate" type="text/html" /><ns0:link href="https://code.google.com/feeds/issues/p/nativeclient/issues/full/1696" rel="self" type="application/atom+xml" /><ns2:stars>1</ns2:stars><ns2:id>1696</ns2:id></ns0:entry>