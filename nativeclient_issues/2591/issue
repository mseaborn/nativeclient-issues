<ns0:entry xmlns:ns0="http://www.w3.org/2005/Atom" xmlns:ns1="http://schemas.google.com/g/2005" xmlns:ns2="http://schemas.google.com/projecthosting/issues/2009" ns1:etag="W/&quot;A0QBRn47eCl7ImA9WhRaEEo.&quot;">
		<ns0:id>http://code.google.com/feeds/issues/p/nativeclient/issues/full/2591</ns0:id><ns0:author>
			<ns0:name>mseaborn@chromium.org</ns0:name><ns0:uri>/u/mseaborn@chromium.org/</ns0:uri></ns0:author><ns0:content type="html">The x86-32 and x86-64 validators both allow alias encodings of the 'set+CONDCODE' instructions.  For example, they allow all of the following:

   20200:	0f 90 c0             	seto   %al
   20203:	0f 90 c8             	seto   %al
   20206:	0f 90 d0             	seto   %al
   20209:	0f 90 d8             	seto   %al
   2020c:	0f 90 e0             	seto   %al
   2020f:	0f 90 e8             	seto   %al
   20212:	0f 90 f0             	seto   %al
   20215:	0f 90 f8             	seto   %al

Only the first is generated by binutils' assembler, so only the first needs to be allowed.

NaCl is currently accepting the &amp;quot;0f 9X /N&amp;quot; forms (for 0&amp;lt;N&amp;lt;8) of the instruction, but the main pages documenting 'setcc' in the AMD manual only list &amp;quot;0f 9X /0&amp;quot;.  (The Intel manual is less specific and does not specify &amp;quot;/0&amp;quot; or &amp;quot;/N&amp;quot; for 'setcc'.)

This issue is similar to issue 2574.

As an aside, the x86-32 version of ncdis disassembles these instructions incorrectly, but that doesn't matter because it does not affect validation.  It outputs:

 20060:	0f 90 c0            	seto %eax
 20063:	0f 90 c8            	seto %ecx
 20066:	0f 90 d0            	seto %edx
 20069:	0f 90 d8            	seto %ebx
 2006c:	0f 90 e0            	seto %esp
 2006f:	0f 90 e8            	seto %ebp
 20072:	0f 90 f0            	seto %esi
 20075:	0f 90 f8            	seto %edi
</ns0:content><ns0:updated>2012-02-12T20:42:37.000Z</ns0:updated><ns0:published>2012-02-12T20:42:37.000Z</ns0:published><ns2:status>New</ns2:status><ns2:cc>
			<ns2:uri>/u/108470876877739532758/</ns2:uri><ns2:username>kschi...@google.com</ns2:username></ns2:cc><ns2:state>open</ns2:state><ns0:title>x86 validators allow alias encodings of the 'setCC' instructions</ns0:title><ns2:label>Type-Defect</ns2:label><ns2:label>Pri-2</ns2:label><ns2:label>Component-TCB-Validator</ns2:label><ns2:label>OS-All</ns2:label><ns2:label>Arch-x86-32</ns2:label><ns2:label>Arch-x86-64</ns2:label><ns0:link href="http://code.google.com/feeds/issues/p/nativeclient/issues/2591/comments/full" rel="replies" type="application/atom+xml" /><ns0:link href="http://code.google.com/p/nativeclient/issues/detail?id=2591" rel="alternate" type="text/html" /><ns0:link href="https://code.google.com/feeds/issues/p/nativeclient/issues/full/2591" rel="self" type="application/atom+xml" /><ns2:stars>1</ns2:stars><ns2:id>2591</ns2:id></ns0:entry>