<ns0:entry xmlns:ns0="http://www.w3.org/2005/Atom" xmlns:ns1="http://schemas.google.com/g/2005" xmlns:ns2="http://schemas.google.com/projecthosting/issues/2009" ns1:etag="W/&quot;A0IERX47eCl7ImA9WhFTGUU.&quot;">
		<ns0:id>http://code.google.com/feeds/issues/p/nativeclient/issues/3486/comments/full/2</ns0:id><ns0:author>
			<ns0:name>mseaborn@chromium.org</ns0:name><ns0:uri>/u/mseaborn@chromium.org/</ns0:uri></ns0:author><ns0:content type="html">For comparison, the correct code generated by nacl-gcc looks like this:

$ objdump -dr toolchain/linux_x86_newlib/lib/gcc/x86_64-nacl/4.4.3/libgcc_eh.a
...
0000000000004860 &lt;_Unwind_Resume&gt;:
...
    49b9:       48 8b 45 d0             mov    -0x30(%rbp),%rax
    49bd:       0f 1f 00                nopl   (%rax)
    49c0:       48 8b 55 d8             mov    -0x28(%rbp),%rdx
    49c4:       48 8b 5d e0             mov    -0x20(%rbp),%rbx
    49c8:       4c 8b 65 e8             mov    -0x18(%rbp),%r12
    49cc:       4c 8b 6d f0             mov    -0x10(%rbp),%r13
    49d0:       4c 8b 75 f8             mov    -0x8(%rbp),%r14
    49d4:       8b 6d 00                mov    0x0(%rbp),%ebp
    49d7:       4c 01 fd                add    %r15,%rbp
    49da:       89 cc                   mov    %ecx,%esp
    49dc:       4c 01 fc                add    %r15,%rsp
...

Or this, for x86-32:
$ objdump -dr toolchain/linux_x86_newlib/lib/gcc/x86_64-nacl/4.4.3/32/libgcc_eh.a
...
    4330:       8b 45 ec                mov    -0x14(%ebp),%eax
    4333:       8b 55 f0                mov    -0x10(%ebp),%edx
    4336:       8b 5d f4                mov    -0xc(%ebp),%ebx
    4339:       8b 75 f8                mov    -0x8(%ebp),%esi
    433c:       8b 7d fc                mov    -0x4(%ebp),%edi
    433f:       90                      nop
    4340:       8b 6d 00                mov    0x0(%ebp),%ebp
    4343:       89 cc                   mov    %ecx,%esp
    4345:       59                      pop    %ecx
    4346:       83 e1 e0                and    $0xffffffe0,%ecx
    4349:       ff e1                   jmp    *%ecx

ARM nacl-gcc also consistently uses this sequence for all libgcc_eh functions using __builtin_eh_return():

$ arm-linux-gnueabi-objdump -drl toolchain/linux_arm_newlib/lib/gcc/arm-nacl/4.8.1/libgcc.a
...
    30e0:       ecbd8b10        vpop    {d8-d15}
    30e4:       e8bd4df3        pop     {r0, r1, r4, r5, r6, r7, r8, sl, fp, lr}
    30e8:       e08dd002        add     sp, sp, r2
    30ec:       e3cdd103        bic     sp, sp, #-1073741824    ; 0xc0000000
    30f0:       e3cee13f        bic     lr, lr, #-1073741809    ; 0xc000000f
    30f4:       e12fff1e        bx      lr
</ns0:content><ns0:updated>2013-06-11T22:25:04.000Z</ns0:updated><ns0:published>2013-06-11T22:25:04.000Z</ns0:published><ns2:updates /><ns0:title>Comment 2 by mseaborn@chromium.org</ns0:title><ns0:link href="http://code.google.com/p/nativeclient/issues/detail?id=3486#c2" rel="alternate" type="text/html" /><ns0:link href="https://code.google.com/feeds/issues/p/nativeclient/issues/3486/comments/full/2" rel="self" type="application/atom+xml" /></ns0:entry>