<ns0:entry xmlns:ns0="http://www.w3.org/2005/Atom" xmlns:ns1="http://schemas.google.com/g/2005" xmlns:ns2="http://schemas.google.com/projecthosting/issues/2009" ns1:etag="W/&quot;AkMBQX47eCl7ImA9WhdaFkU.&quot;">
		<ns0:id>http://code.google.com/feeds/issues/p/nativeclient/issues/2394/comments/full/28</ns0:id><ns0:author>
			<ns0:name>dmichael@chromium.org</ns0:name><ns0:uri>/u/dmichael@chromium.org/</ns0:uri></ns0:author><ns0:content type="html">I agree, the log shows the failure:
[  2928 ms] |||| [PPB_Graphics2D::ScrollEntire FAIL] ('&#202;&#231;&#236;&#202;&#937;&#8804;&#202;&#177;&#168;&#202;&#960;&#214;&#202;&#8226;&#165;&#202;&#239;&#8804;&#202;&#177;&#220;&#193;&#231;&#181;&#8240;&#231;&#174;&#202;&#177;&#176;&#202;&#226;&#168;&#202;&#231;&#176;k&#202;&#229;&#244;&#172;&#170;&#8222;&#214;&#198;&#183;&#168;&#237;' != 'ScrollEntireFlushCallback')
And clearly shows valid strings from the log message you added (including ScrollEntireFlushCallback), and none of those log messages show the error.

I was planning on logging in remotely to debug, but my MBP has bricked itself with a required security update. I'm happy to help out tomorrow as much as I can. I've tried poking around at the code from my home machine to look for mistakes in chromium with no luck so far.

Some possibilities for where the error lies:
- CopyPPVar. The ref counting is tricky here, but it looks right to me. If it's wrong, it could cause the problem if the underlying string in the PP_Var was deleted before the PostMessageToJavaScriptImpl got invoked later. But that should probably fail in a more obvious way, because I would expect the PP_Var's id to not be found.
Within PostMessageToJavaScriptImpl:
- PPVarToNPVariantNoCopy - converts the string to a string NPVariant. This is dependent on WebKit::WebBindings, so a WebKit mistake could explain it.
- Invoking the javascript function to send the data (WebBindings::invokeDefault). This is also implemented by WebKit + V8, so if a WebKit DEPS roll correlates with the problem, it's also suspect.

I see this is marked Mstone-16...  so I take it that the problem happens in Chrome 16 (i.e., Beta?). I'm currently reworking this part of the implementation, probably in 17. It would be best to understand the issue... but I may be able to work around it for 17, since the new implementation will take a fairly different code path (using WebKit directly instead of evaluating javascript).</ns0:content><ns0:updated>2011-10-27T04:07:30.000Z</ns0:updated><ns0:published>2011-10-27T04:07:30.000Z</ns0:published><ns2:updates /><ns0:title>Comment 28 by dmichael@chromium.org</ns0:title><ns0:link href="http://code.google.com/p/nativeclient/issues/detail?id=2394#c28" rel="alternate" type="text/html" /><ns0:link href="https://code.google.com/feeds/issues/p/nativeclient/issues/2394/comments/full/28" rel="self" type="application/atom+xml" /></ns0:entry>